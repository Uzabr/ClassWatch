<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ClassWatch ‚Äî –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
</head>
<body class="bg-gray-100 text-gray-800 min-h-screen p-6">
<div class="max-w-7xl mx-auto">
    <h1 class="text-4xl font-bold text-center mb-10 text-blue-700">–†–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞–Ω–∞–ª–∏–∑–∞</h1>

    <!-- –ü—Ä—è–º–æ—É–≥–æ–ª—å–Ω—ã–π –≥—Ä–∞—Ñ–∏–∫ —Å–æ —à–∫–∞–ª–æ–π -->
    <div class="bg-white rounded-xl shadow-md p-6 mb-10">
        <h2 class="text-2xl font-semibold mb-4">–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ —Å—Ç–∞—Ç—É—Å–∞–º</h2>
        <canvas id="statusChart"></canvas>
    </div>

    <!-- –†–∞–∑–¥–µ–ª—ë–Ω–Ω—ã–µ —Å–ø–∏—Å–∫–∏ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ —Å —Ä–∞—Å–∫—Ä—ã—Ç–∏–µ–º -->
    <div class="space-y-6 mb-10">
        <!-- –®–∞–±–ª–æ–Ω –¥–ª—è —Ä–∞—Å–∫—Ä—ã–≤–∞—é—â–∏—Ö—Å—è —Å–ø–∏—Å–∫–æ–≤ -->
        <div class="bg-white rounded-xl shadow-md overflow-hidden">
            <button onclick="toggleSection('deadlineList')" class="w-full text-left px-6 py-4 text-red-600 text-xl font-semibold hover:bg-gray-50 transition">
                üìå –°–∫–æ—Ä–æ –¥–µ–¥–ª–∞–π–Ω (‚â§ 10 –¥–Ω–µ–π)
            </button>
            <div id="deadlineList" class="hidden px-6 pb-4">
                <ul class="space-y-2">
                    <li th:each="s : ${soonDeadline}" class="flex justify-between border-b pb-1">
                        <span th:text="${s.login}" class="font-medium"></span>
                        <span th:text="${s.daysToDeadline + ' –¥–Ω–µ–π'}" class="text-red-600 font-bold"></span>
                    </li>
                </ul>
            </div>
        </div>

        <div class="bg-white rounded-xl shadow-md overflow-hidden">
            <button onclick="toggleSection('blockedList')" class="w-full text-left px-6 py-4 text-gray-800 text-xl font-semibold hover:bg-gray-50 transition">
                ‚õî –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω—ã
            </button>
            <div id="blockedList" class="hidden px-6 pb-4">
                <ul class="space-y-2">
                    <li th:each="s : ${blocked}" class="flex justify-between border-b pb-1">
                        <span th:text="${s.login}" class="font-medium"></span>
                        <span th:text="${s.status}" class="text-red-500"></span>
                    </li>
                </ul>
            </div>
        </div>

        <div class="bg-white rounded-xl shadow-md overflow-hidden">
            <button onclick="toggleSection('frozenList')" class="w-full text-left px-6 py-4 text-gray-800 text-xl font-semibold hover:bg-gray-50 transition">
                ‚ùÑÔ∏è –ó–∞–º–æ—Ä–æ–∂–µ–Ω—ã
            </button>
            <div id="frozenList" class="hidden px-6 pb-4">
                <ul class="space-y-2">
                    <li th:each="s : ${frozen}" class="flex justify-between border-b pb-1">
                        <span th:text="${s.login}" class="font-medium"></span>
                        <span th:text="${s.status}" class="text-blue-500"></span>
                    </li>
                </ul>
            </div>
        </div>
    </div>

    <!-- –ü–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤ -->
    <div class="bg-white rounded-xl shadow-md p-6 overflow-x-auto">
        <h2 class="text-2xl font-semibold mb-4">–ü–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤</h2>
        <table class="w-full text-sm text-left border-collapse">
            <thead>
            <tr class="bg-gray-200">
                <th class="px-4 py-2">–õ–æ–≥–∏–Ω</th>
                <th class="px-4 py-2">–°—Ç–∞—Ç—É—Å</th>
                <th class="px-4 py-2">–¢—Ä–∞–π–±</th>
                <th class="px-4 py-2">–£—Ä–æ–≤–µ–Ω—å</th>
                <th class="px-4 py-2">–¶–µ–ª—å</th>
                <th class="px-4 py-2">–î–µ–¥–ª–∞–π–Ω</th>
                <th class="px-4 py-2">–î–Ω–µ–π –¥–æ –¥–µ–¥–ª–∞–π–Ω–∞</th>
            </tr>
            </thead>
            <tbody>
            <tr th:each="student : ${students}" class="hover:bg-gray-100">
                <td class="border-t px-4 py-2" th:text="${student.login}"></td>
                <td class="border-t px-4 py-2" th:text="${student.status}"></td>
                <td class="border-t px-4 py-2" th:text="${student.tribe}"></td>
                <td class="border-t px-4 py-2" th:text="${student.level}"></td>
                <td class="border-t px-4 py-2" th:text="${student.targetLevel}"></td>
                <td class="border-t px-4 py-2" th:text="${student.deadline}"></td>
                <td class="border-t px-4 py-2" th:text="${student.daysToDeadline}"></td>
            </tr>
            </tbody>
        </table>
    </div>
</div>

<script th:inline="javascript">
    const statusCounts = /*[[${statusCounts}]]*/ {};
    const ctx = document.getElementById('statusChart');

    new Chart(ctx, {
        type: 'bar',
        data: {
            labels: Object.keys(statusCounts),
            datasets: [{
                label: '–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—Ç—É–¥–µ–Ω—Ç–æ–≤',
                data: Object.values(statusCounts),
                backgroundColor: 'rgba(54, 162, 235, 0.7)',
                borderRadius: 6
            }]
        },
        options: {
            responsive: true,
            animation: {
                duration: 1000,
                easing: 'easeOutQuart'
            },
            plugins: {
                legend: { display: false }
            },
            scales: {
                y: {
                    beginAtZero: true,
                    ticks: { stepSize: 1 }
                }
            }
        }
    });

    function toggleSection(id) {
        const el = document.getElementById(id);
        el.classList.toggle('hidden');
    }
</script>
</body>
</html>
